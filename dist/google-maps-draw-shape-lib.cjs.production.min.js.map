{"version":3,"file":"google-maps-draw-shape-lib.cjs.production.min.js","sources":["../src/MapDrawShape/Overlays/CustomOverlayView.js","../src/MapDrawShape/Map/MapHelper.js","../src/MapDrawShape/Geometry/JstsHelper.js","../src/MapDrawShape/MapDrawShapeManager.js"],"sourcesContent":["export default class CustomOverlayView {\n  /**\n   * @param {string} content String with the inner HTML of the overlay\n   * @param {google.maps.LatLng} position Google LatLng object with the position of the overlay on the map\n   * @param {Function} callback Funcion to be called when click in the overlay\n   */\n  constructor(content, position, callback) {\n    this.content = content;\n    this.position = position;\n    this.callback = callback;\n\n    // Typescript ReferenceError: google is not defined\n    // It is not possible to directly extend a google.maps.* class since it actually isn't available\n    this.extend(CustomOverlayView, google.maps.OverlayView);\n  }\n\n  onAdd = () => {\n    this.div = document.createElement('div');\n    this.div.style.cssText = 'position: absolute; transform: translate(-50%, -50%);';\n    this.div.innerHTML = this.content;\n\n    if (this.callback) {\n      google.maps.event.addDomListener(this.div, 'click', this.callback);\n    }\n\n    this.getPanes().floatPane.appendChild(this.div);\n  };\n\n  onRemove = () => {\n    if (this.div) {\n      google.maps.event.clearInstanceListeners(this.div);\n\n      this.div.parentNode.removeChild(this.div);\n      delete this.div;\n    }\n  };\n\n  close = () => {\n    this.setMap(null);\n  };\n\n  draw = () => {\n    const position = this.position;\n\n    const projection = this.getProjection();\n\n    if (!position || !projection) {\n      return;\n    }\n\n    const point = projection.fromLatLngToDivPixel(position);\n\n    if (this.div) {\n      this.div.style.top = point.y + 'px';\n      this.div.style.left = point.x + 'px';\n    }\n  };\n\n  show = (map) => {\n    this.setMap(map);\n\n    this.draw();\n  };\n\n  remove = () => {\n    this.close();\n  };\n\n  extend = (type1, type2) => {\n    for (let property in type2.prototype) {\n      type1.prototype[property] = type2.prototype[property];\n    }\n  };\n}\n","export default class MapFunctions {\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @returns {number} Current zoom level of the map\n   */\n  static getZoom = (map) => {\n    return map.getZoom();\n  };\n\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @returns {any} Object with NW and SE bounds of the map\n   */\n  static getBounds = (map) => {\n    const bounds = map.getBounds();\n\n    const ne = bounds.getNorthEast();\n    const sw = bounds.getSouthWest();\n\n    return bounds;\n  };\n\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @param {any} point Object with clientX and clientY screen coordinates\n   * @returns {google.maps.LatLng} Object with Lat and Lng\n   */\n  static pointToLatLng = (map, point) => {\n    const clientRect = map.getDiv().getBoundingClientRect();\n\n    const clientX = point.clientX - clientRect.left;\n    const clientY = point.clientY - clientRect.top;\n\n    const projection = map.getProjection();\n    const bounds = map.getBounds();\n\n    const ne = bounds.getNorthEast();\n    const sw = bounds.getSouthWest();\n\n    const topRight = projection.fromLatLngToPoint(ne);\n    const bottomLeft = projection.fromLatLngToPoint(sw);\n\n    const zoom = MapFunctions.getZoom(map);\n    const scale = Math.pow(2, zoom);\n\n    return projection.fromPointToLatLng(new google.maps.Point(clientX / scale + bottomLeft.x, clientY / scale + topRight.y));\n  };\n\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @param {boolean} freeze Flag indicating whether it should freeze the map\n   */\n  static freezeMap = (map, freeze) => {\n    map.setOptions({\n      draggable: !freeze,\n      scrollwheel: !freeze,\n      draggableCursor: freeze ? 'pointer' : null,\n      disableDoubleClickZoom: freeze\n    });\n  };\n\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @param {boolean} enable Flag indicating whether it should enable crossair cursor over the map\n   */\n  static enableCrossair = (map, enable) => {\n    map.setOptions({\n      draggableCursor: enable ? 'crosshair' : null,\n      disableDoubleClickZoom: enable\n    });\n  };\n}\n","import * as jsts from 'jsts/dist/jsts';\n\nexport default class JstsHelper {\n  /**\n   * @param {object[]} shape Array of objects that contain lat lng values\n   * @param {bool} validate Flag indicating whether it should validate the shape\n   * @returns {object[]} Array of that contains polygons that are Lists of google.maps.LatLng objects\n   */\n  static processShape = (shape, validate) => {\n    let polygons = [];\n\n    if (shape?.length > 2) {\n      let shapePolygons = [];\n\n      let polygon = [];\n\n      let firstCoordinate = null;\n\n      for (let i = 0; i < shape.length; i++) {\n        if (!firstCoordinate) {\n          firstCoordinate = shape[i];\n\n          polygon = [];\n          polygon.push(validate ? new jsts.geom.Coordinate(shape[i].lng, shape[i].lat) : new google.maps.LatLng(shape[i].lat, shape[i].lng));\n\n          continue;\n        }\n\n        polygon.push(validate ? new jsts.geom.Coordinate(shape[i].lng, shape[i].lat) : new google.maps.LatLng(shape[i].lat, shape[i].lng));\n\n        if (firstCoordinate.lat === shape[i].lat && firstCoordinate.lng === shape[i].lng) {\n          if (polygon.length > 3) {\n            shapePolygons.push(polygon);\n          }\n\n          firstCoordinate = null;\n        } else {\n          if (i === shape.length - 1) {\n            polygon.push(polygon[0]);\n\n            if (polygon.length > 3) {\n              shapePolygons.push(polygon);\n            }\n          }\n        }\n      }\n\n      if (!validate) {\n        polygons = shapePolygons;\n      } else {\n        if (shapePolygons.length > 0) {\n          const geometryFactory = new jsts.geom.GeometryFactory();\n\n          const jstsPolygons = shapePolygons.map((item) => {\n            const shell = geometryFactory.createLinearRing(item);\n            return geometryFactory.createPolygon(shell);\n          });\n\n          const jstsPolygon = jstsPolygons.length > 1 ? geometryFactory.createMultiPolygon(jstsPolygons) : jstsPolygons[0];\n\n          const validPolygon = this.#validateGeometry(jstsPolygon);\n\n          if (validPolygon && validPolygon.getCoordinates().length) {\n            polygons = this.#convertFromJstsGeometry(validPolygon);\n          }\n        }\n      }\n    }\n\n    return shape;\n  };\n\n  /**\n   * @param {google.maps.LatLng[]} path Array of google.maps.LatLng objects\n   * @param {number} simplifyZoom Zoom level to take into account when simplifying the shape\n   * @returns {object[]} Array of that contains polygons that are Lists of google.maps.LatLng objects\n   */\n  static processPolygon = (path, simplifyZoom) => {\n    let polygons = [];\n\n    if (path?.length > 2) {\n      const coordinates = path.map((item) => {\n        return new jsts.geom.Coordinate(item.lng(), item.lat());\n      });\n\n      if (coordinates.length > 0) {\n        coordinates.push(coordinates[0]);\n      }\n\n      const geometryFactory = new jsts.geom.GeometryFactory();\n\n      const shell = geometryFactory.createLinearRing(coordinates);\n\n      let jstsPolygon = geometryFactory.createPolygon(shell);\n\n      if (simplifyZoom) {\n        jstsPolygon = this.#simplifyPolygon(jstsPolygon, simplifyZoom);\n      }\n\n      const validPolygon = this.#validateGeometry(jstsPolygon);\n\n      if (validPolygon && validPolygon.getCoordinates().length) {\n        polygons = this.#convertFromJstsGeometry(validPolygon);\n      }\n    }\n\n    return path;\n  };\n\n  static #simplifyPolygon = (polygon, zoom) => {\n    let tolerance = 0.1;\n\n    switch (zoom) {\n      case 7:\n      case 8:\n      case 9: {\n        tolerance = 0.01;\n        break;\n      }\n      case 10:\n      case 11:\n      case 12:\n      case 13: {\n        tolerance = 0.001;\n        break;\n      }\n      case 14:\n      case 15:\n      case 16:\n      case 17: {\n        tolerance = 0.0001;\n        break;\n      }\n      case 18:\n      case 19:\n      case 20:\n      case 21:\n      case 22: {\n        tolerance = 0.00001;\n        break;\n      }\n      default:\n        tolerance = 0.1;\n    }\n\n    return jsts.simplify.TopologyPreservingSimplifier.simplify(polygon, tolerance);\n  };\n\n  static #convertFromJstsGeometry = (geom) => {\n    let polygons = [];\n\n    // Sets shape on clockwise order\n    geom.normalize();\n\n    if (geom instanceof jsts.geom.Polygon) {\n      const polygon = this.#convertFromJstsCoordinates(geom.getCoordinates());\n\n      polygons.push(polygon);\n    }\n\n    if (geom instanceof jsts.geom.MultiPolygon) {\n      for (let n = geom.getNumGeometries(); n > 0; n--) {\n        const polygon = this.#convertFromJstsCoordinates(geom.getGeometryN(n - 1).getCoordinates());\n\n        polygons.push(polygon);\n      }\n    }\n\n    return polygons;\n  };\n\n  static #convertFromJstsCoordinates = (coordinates) => {\n    let path = [];\n\n    if (coordinates) {\n      let lastCoordinate = null;\n\n      for (let i = 0; i < coordinates.length; i++) {\n        if (!lastCoordinate || !(lastCoordinate.x === coordinates[i].x && lastCoordinate.y === coordinates[i].y)) {\n          lastCoordinate = coordinates[i];\n\n          path.push(new google.maps.LatLng(lastCoordinate.y, lastCoordinate.x));\n        }\n      }\n    }\n\n    return path;\n  };\n\n  static #validateGeometry = (geom) => {\n    if (geom instanceof jsts.geom.Polygon) {\n      if (geom.isValid()) {\n        return geom;\n      }\n\n      let polygonizer = new jsts.operation.polygonize.Polygonizer();\n\n      this.#addPolygon(geom, polygonizer);\n\n      return this.#toPolygonGeometry(polygonizer.getPolygons());\n    } else if (geom instanceof jsts.geom.MultiPolygon) {\n      if (geom.isValid()) {\n        return geom;\n      }\n\n      let polygonizer = new jsts.operation.polygonize.Polygonizer();\n\n      for (let n = geom.getNumGeometries(); n > 0; n--) {\n        this.#addPolygon(geom.getGeometryN(n - 1), polygonizer);\n      }\n\n      return this.#toPolygonGeometry(polygonizer.getPolygons());\n    } else {\n      return geom;\n    }\n  };\n\n  static #addPolygon = (polygon, polygonizer) => {\n    this.#addLineString(polygon.getExteriorRing(), polygonizer);\n\n    for (let n = polygon.getNumInteriorRing(); n > 0; n--) {\n      this.#addLineString(polygon.getInteriorRingN(n), polygonizer);\n    }\n  };\n\n  static #addLineString = (lineString, polygonizer) => {\n    if (lineString instanceof jsts.geom.LinearRing) {\n      lineString = lineString.getFactory().createLineString(lineString.getCoordinateSequence());\n    }\n\n    let point = lineString.getFactory().createPoint(lineString.getCoordinateN(0));\n    let toAdd = lineString.union(point);\n\n    polygonizer.add(toAdd);\n  };\n\n  static #toPolygonGeometry = (polygons) => {\n    switch (polygons.size()) {\n      case 0:\n        return null;\n      case 1:\n        return polygons.iterator().next();\n      default:\n        let iter = polygons.iterator();\n        let ret = iter.next();\n\n        while (iter.hasNext()) {\n          ret = ret.symDifference(iter.next());\n        }\n\n        return ret;\n    }\n  };\n}\n","import CustomOverlayView from './Overlays/CustomOverlayView';\nimport MapFunctions from './Map/MapHelper';\nimport JstsHelper from './Geometry/JstsHelper';\n\nexport default class MapDrawShapeManager {\n  /**\n   * @param {google.maps.Map} map Google Maps JavaScript API instance\n   * @param {Function} callback Callback function that will be called when user draws or clears the draw\n   * @param {boolean} drawingMode Flag indicating whether it should set Drawing Mode enabled\n   * @param {boolean} drawFreeHandMode Flag indicating whether it should set Draw Free Hand Mode enabled\n   * @param {object} polygonOptions Object containing the google polygon options to be used when drawing\n   * @param {string} initialPointInnerHtml String with the inner HTML of the draw initial point overlay\n   * @param {string} deletePointInnerHtml String with the inner HTML of the draw delete point overlay\n   */\n  constructor(map, callback, drawingMode, drawFreeHandMode, polygonOptions, initialPointInnerHtml, deletePointInnerHtml) {\n    this.map = map;\n\n    this.callback = callback;\n\n    this.drawFreeHandMode = drawFreeHandMode;\n\n    this.polygonOptions = polygonOptions;\n\n    this.initialPointInnerHtml = initialPointInnerHtml;\n    this.deletePointInnerHtml = deletePointInnerHtml;\n\n    this.initialDrawPoint = null;\n\n    this.startedDrawing = false;\n    this.startedDrawingFreeHand = false;\n\n    this.drawnPolylineDraft = null;\n    this.drawnPolygonDraft = null;\n\n    this.drawnShape = null;\n    this.deleteDrawnShape = null;\n\n    this.setDrawingMode(drawingMode);\n  }\n\n  /**\n   * It draws a shape on the map using the provided shape\n   * @param {object[]} initialShape Array of objects that contain lat lng values\n   */\n  initDrawnShape = (initialShape) => {\n    if (initialShape?.length > 0 && !this.drawnShape) {\n      const polygons = JstsHelper.processShape(initialShape);\n\n      if (polygons.length > 0) {\n        this.drawnShape = [];\n\n        polygons.forEach((p) => {\n          this.drawnShape.push(new google.maps.Polygon({ path: p, ...this.polygonOptions }));\n        });\n\n        this.#setDeleteDrawPoint();\n      }\n    }\n  };\n\n  /**\n   * It resets the shape drawn on the map\n   */\n  resetDrawnShape = () => {\n    if (this.drawnShape) this.drawnShape.forEach((p) => p.setMap(null));\n    if (this.deleteDrawnShape) this.deleteDrawnShape.remove();\n\n    this.drawnShape = null;\n    this.deleteDrawnShape = null;\n  };\n\n  /**\n   * It sets the drawing mode to free hand, when enabled user should drag to draw instead of click\n   * @param {boolean} enabled Flag indicating whether it should set Draw Free Hand Mode enabled\n   */\n  setDrawFreeHandMode = (enabled) => {\n    if (!this.startedDrawing && !this.startedDrawingFreeHand) {\n      this.drawFreeHandMode = enabled;\n    }\n  };\n\n  /**\n   * It sets the map in drawing mode, when enabled user can star drawing\n   * @param {boolean} enabled Flag indicating whether it should set Drawing Mode enabled\n   */\n  setDrawingMode = (enabled) => {\n    if (enabled) {\n      if (this.drawnShape) this.drawnShape.forEach((p) => p.setMap(null));\n      if (this.deleteDrawnShape) this.deleteDrawnShape.remove();\n\n      if (this.drawFreeHandMode) {\n        this.#initDrawFreeHand();\n      } else {\n        this.#initDraw();\n      }\n    } else {\n      if (this.initialDrawPoint) this.initialDrawPoint.remove();\n      this.initialDrawPoint = null;\n\n      if (this.drawFreeHandMode) {\n        if (this.startedDrawingFreeHand) {\n          this.startedDrawingFreeHand = false;\n\n          MapFunctions.freezeMap(this.map, false);\n\n          if (this.drawnShape) this.drawnShape.forEach((p) => p.setMap(this.map));\n          if (this.deleteDrawnShape) this.deleteDrawnShape.show(this.map);\n\n          this.#clearDrawFreeHandListeners();\n        }\n      } else {\n        if (this.startedDrawing) {\n          this.startedDrawing = false;\n\n          MapFunctions.enableCrossair(this.map, false);\n\n          if (this.drawnPolylineDraft) this.drawnPolylineDraft.setMap(null);\n          if (this.drawnPolygonDraft) this.drawnPolygonDraft.setMap(null);\n\n          this.drawnPolylineDraft = null;\n          this.drawnPolygonDraft = null;\n\n          if (this.drawnShape) this.drawnShape.forEach((p) => p.setMap(this.map));\n          if (this.deleteDrawnShape) this.deleteDrawnShape.show(this.map);\n\n          this.#clearDrawListeners();\n        }\n      }\n    }\n  };\n\n  #setInitialDrawPoint = (point, callback) => {\n    this.initialDrawPoint = new CustomOverlayView(this.initialPointInnerHtml, point, callback);\n\n    this.initialDrawPoint.show(this.map);\n  };\n\n  #setDeleteDrawPoint = () => {\n    this.deleteDrawnShape = new CustomOverlayView(this.deletePointInnerHtml, this.#getDrawnShapeHighestPoint(), () => {\n      if (this.drawnShape) this.drawnShape.forEach((p) => p.setMap(null));\n      if (this.deleteDrawnShape) this.deleteDrawnShape.remove();\n\n      this.drawnShape = null;\n      this.deleteDrawnShape = null;\n\n      this.callback([]);\n    });\n\n    if (!this.startedDrawing && !this.startedDrawingFreeHand) {\n      this.drawnShape.forEach((p) => p.setMap(this.map));\n      this.deleteDrawnShape.show(this.map);\n    }\n  };\n\n  #getDrawnShapeHighestPoint = () => {\n    let highestPoint = null;\n    let maxLat = 0;\n\n    this.drawnShape.forEach((polygon) => {\n      polygon\n        .getPath()\n        .getArray()\n        .forEach((point) => {\n          const lat = point.lat();\n\n          if (lat > maxLat) {\n            maxLat = lat;\n            highestPoint = point;\n          }\n        });\n    });\n\n    return highestPoint;\n  };\n\n  #initDraw = () => {\n    if (!this.startedDrawing) {\n      this.startedDrawing = true;\n\n      MapFunctions.enableCrossair(this.map, true);\n\n      this.#draw();\n    }\n  };\n\n  #draw = () => {\n    this.drawnPolylineDraft = new google.maps.Polyline({ map: this.map, ...this.polygonOptions });\n    this.drawnPolygonDraft = new google.maps.Polygon({ map: this.map, ...this.polygonOptions, strokeOpacity: 0 });\n\n    google.maps.event.addDomListener(this.map.getDiv(), 'click', (e) => {\n      const latLng = MapFunctions.pointToLatLng(this.map, e);\n\n      if (!this.initialDrawPoint) {\n        this.#setInitialDrawPoint(latLng, () => {\n          polylinePath.removeAt(polylinePath.length - 1);\n\n          this.#drawComplete();\n        });\n      }\n\n      const polylinePath = this.drawnPolylineDraft.getPath();\n\n      if (polylinePath.length > 0) {\n        polylinePath.removeAt(polylinePath.length - 1);\n      }\n\n      polylinePath.push(latLng);\n      polylinePath.push(latLng);\n\n      this.drawnPolygonDraft.setPath(polylinePath);\n    });\n\n    google.maps.event.addDomListener(this.map.getDiv(), 'mousemove', (e) => {\n      const polylinePath = this.drawnPolylineDraft.getPath();\n\n      if (polylinePath.length > 0) {\n        const latLng = MapFunctions.pointToLatLng(this.map, e);\n\n        polylinePath.setAt(polylinePath.length - 1, latLng);\n      }\n    });\n\n    google.maps.event.addListenerOnce(this.map, 'dblclick', () => {\n      setTimeout(() => {\n        this.#drawComplete();\n      }, 1);\n    });\n  };\n\n  #drawComplete = () => {\n    this.#clearDrawListeners();\n\n    this.startedDrawing = false;\n\n    MapFunctions.enableCrossair(this.map, false);\n\n    if (this.initialDrawPoint) this.initialDrawPoint.remove();\n    this.initialDrawPoint = null;\n\n    this.drawnPolylineDraft.setMap(null);\n    this.drawnPolygonDraft.setMap(null);\n\n    const polygons = JstsHelper.processPolygon(this.drawnPolygonDraft.getPath().getArray());\n\n    if (polygons.length > 0) {\n      this.drawnShape = [];\n\n      let shape = [];\n\n      polygons.forEach((p) => {\n        this.drawnShape.push(new google.maps.Polygon({ path: p, ...this.polygonOptions }));\n\n        shape = shape.concat(\n          p.map((item) => {\n            return { lat: item.lat(), lng: item.lng() };\n          })\n        );\n      });\n\n      this.#setDeleteDrawPoint();\n\n      this.callback(shape);\n    } else {\n      this.#initDraw();\n    }\n  };\n\n  #clearDrawListeners = () => {\n    google.maps.event.clearListeners(this.map.getDiv(), 'click');\n    google.maps.event.clearListeners(this.map.getDiv(), 'mousemove');\n    google.maps.event.clearListeners(this.map, 'dblclick');\n  };\n\n  #initDrawFreeHand = () => {\n    if (!this.startedDrawingFreeHand) {\n      this.startedDrawingFreeHand = true;\n\n      MapFunctions.freezeMap(this.map, true);\n\n      this.#drawFreeHand();\n    }\n  };\n\n  #drawFreeHand = () => {\n    this.drawnPolylineDraft = new google.maps.Polyline({ map: this.map, ...this.polygonOptions });\n\n    google.maps.event.addListenerOnce(this.map, 'mousedown', (e) => {\n      event.preventDefault(); // eslint-disable-line no-restricted-globals\n      event.stopPropagation(); // eslint-disable-line no-restricted-globals\n\n      if (!this.initialDrawPoint) {\n        this.#setInitialDrawPoint(e.latLng);\n      }\n\n      this.drawnPolylineDraft.getPath().push(e.latLng);\n\n      google.maps.event.addListener(this.map, 'mousemove', (e) => {\n        this.drawnPolylineDraft.getPath().push(e.latLng);\n      });\n\n      google.maps.event.addListenerOnce(this.map, 'mouseup', () => {\n        this.#drawFreeHandComplete();\n      });\n    });\n  };\n\n  #drawFreeHandComplete = () => {\n    this.#clearDrawFreeHandListeners();\n\n    this.startedDrawingFreeHand = false;\n\n    MapFunctions.freezeMap(this.map, false);\n\n    if (this.initialDrawPoint) this.initialDrawPoint.remove();\n    this.initialDrawPoint = null;\n\n    this.drawnPolylineDraft.setMap(null);\n\n    const polygons = JstsHelper.processPolygon(this.drawnPolylineDraft.getPath().getArray(), MapFunctions.getZoom(this.map));\n\n    if (polygons.length > 0) {\n      this.drawnShape = [];\n\n      let shape = [];\n\n      polygons.forEach((p) => {\n        this.drawnShape.push(new google.maps.Polygon({ path: p, ...this.polygonOptions }));\n\n        shape = shape.concat(\n          p.map((item) => {\n            return { lat: item.lat(), lng: item.lng() };\n          })\n        );\n      });\n\n      this.#setDeleteDrawPoint();\n\n      this.callback(shape);\n    } else {\n      this.#initDrawFreeHand();\n    }\n  };\n\n  #clearDrawFreeHandListeners = () => {\n    google.maps.event.clearListeners(this.map, 'mousedown');\n    google.maps.event.clearListeners(this.map, 'mousemove');\n    google.maps.event.clearListeners(this.map, 'mouseup');\n  };\n}\n"],"names":["CustomOverlayView","content","position","callback","onAdd","_this","div","document","createElement","style","cssText","innerHTML","google","maps","event","addDomListener","getPanes","floatPane","appendChild","onRemove","clearInstanceListeners","parentNode","removeChild","close","setMap","draw","projection","getProjection","point","fromLatLngToDivPixel","top","y","left","x","show","map","remove","extend","type1","type2","property","prototype","OverlayView","MapFunctions","getZoom","getBounds","bounds","getNorthEast","getSouthWest","pointToLatLng","clientRect","getDiv","getBoundingClientRect","clientX","clientY","ne","sw","topRight","fromLatLngToPoint","bottomLeft","zoom","scale","Math","pow","fromPointToLatLng","Point","freezeMap","freeze","setOptions","draggable","scrollwheel","draggableCursor","disableDoubleClickZoom","enableCrossair","enable","JstsHelper","processShape","shape","validate","length","shapePolygons","polygon","firstCoordinate","i","push","jsts","Coordinate","lng","lat","LatLng","geometryFactory","GeometryFactory","jstsPolygons","item","shell","createLinearRing","createPolygon","jstsPolygon","createMultiPolygon","validPolygon","getCoordinates","processPolygon","path","simplifyZoom","coordinates","tolerance","TopologyPreservingSimplifier","simplify","geom","polygons","normalize","Polygon","MultiPolygon","n","getNumGeometries","getGeometryN","lastCoordinate","isValid","polygonizer","polygonize","Polygonizer","getPolygons","getExteriorRing","getNumInteriorRing","getInteriorRingN","lineString","LinearRing","getFactory","createLineString","getCoordinateSequence","createPoint","getCoordinateN","toAdd","union","add","size","iterator","next","iter","ret","hasNext","symDifference","drawingMode","drawFreeHandMode","polygonOptions","initialPointInnerHtml","deletePointInnerHtml","initDrawnShape","initialShape","drawnShape","forEach","p","resetDrawnShape","deleteDrawnShape","setDrawFreeHandMode","enabled","startedDrawing","startedDrawingFreeHand","setDrawingMode","initialDrawPoint","drawnPolylineDraft","drawnPolygonDraft","highestPoint","maxLat","getPath","getArray","Polyline","strokeOpacity","e","latLng","polylinePath","removeAt","setPath","setAt","addListenerOnce","setTimeout","concat","clearListeners","preventDefault","stopPropagation","addListener"],"mappings":"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"}